---
title: "Introduction to Bayesian record linkage "
author: Brenda Betancourt and Andee Kaplan
institute: |
    | Duke University
    | Department of Statistical Science
shortinstitute: Duke University
date: |
  | February 8, 2018
  |
  | Slides available at <http://bit.ly/cimat-bayes>
  |
output: 
  beamer_presentation:
    keep_tex: false
    template: beamer.tex
fig_caption: true
classoption: compress
natbib: true
---

# Why Bayes?

A Bayesian framework is suitable to solve the following
problems:

\vspace{1mm}

- Exact computation of the probability that each pair is a match,
conditional on the observed data. 
    * Results conditioning on observed events are more directly interpretable than those obtained by conditioning on unobservable hypotheses.

\vspace{2mm}

- Propagating linkage error as an added component of uncertainty in the estimation process.
    * Relevant for subsequent modeling.


# The Fellegi-Sunter approach (1969)

- Represent every pair of records using vector of features that describe similarity between individual record fields. 
    * Use string metrics (Jaro-Winkler) and edit-distances for names and strings        of numbers.

\vspace{2mm}

- Place feature vectors for record pairs into three classes: matches $(M)$, nonmatches $(U)$, and possible matches.

\vspace{2mm}

- Let $P(\gamma|M)$ and $P(\gamma|U)$ be probabilities of observing a feature vector $\gamma$ for a matched and nonmatched pair, respectively.

# The Fellegi-Sunter approach (1969)

- Perform record-pair classification by calculating the ratio $(P(\gamma|M)/P(\gamma|U))$ for each candidate record pair.

\vspace{2mm}

- Establish two thresholds based on desired error levels to optimally separate the ratio values for matches, possibly matches, and nonmatches.

\vspace{2mm}

-  \textcolor{blue}{Drawbacks}: only for two files, no trasitive closures.

# Fellegi-Sunter generalization


- Extension for multiple files solving the problem of non–transitive decisions.

\vspace{2mm}

- Provide matching probabilities for the record K-tuples, necessary to incorporate the uncertainty of the linkage procedure in posterior analysis

\vspace{2mm}

- M. Sadinle and S.E. Fienberg (2013). “A Generalized Fellegi-Sunter Framework for Multiple Record Linkage With Application to Homicide Record Systems.” J. Amer. Statist. Assoc., 108 (502), 385–397.

<!-- 67 homicides recorded by Colombia DANE, 62 by National Police, and 33 Forensics Institute (medicina legal) --> 


# Clustering Approaches

- Record linkage can be naturally seen as a clustering problem.
    * Supervised and unsupervised approches.
    
\vspace{2mm}

- Records representing the same individual are clustered to a latent entity producing a partition of the data.
    * Steorts, R., Hall, R., and Fienberg, S.E. (2016). A Bayesian Approach to Graphical Record Linkage and De-duplication, Journal of the American Statistical Association, 111:516 (1660-1672).
    * Sadinle, M. (2014). Detecting duplicates in a homicide registry using a
275 bayesian partitioning approach. The Annals of Applied Statistics, Vol. 8, No. 4, 2404–2434

# Graphical Record Linkage

Graphical model representation of  \textcolor{blue}{Steorts et al. (2016)}:
\begin{figure}
\includegraphics[scale=0.35,keepaspectratio]{figures/recordLinkage_graphicalModel}
\end{figure}
- $\Lambda_{ij}$ represents the linkage structure $\rightarrow$  \textcolor{blue}{uniform prior}.
<!--uniform over the set of {1,...,N}
such that each record is assumed to be equally likely a priori to correspond to any of the N latent individuals. Thus, it treats the records as if they are a random sample drawn with replacement.
% any two partitions with the same number of latent entities are equally probably a priori.--> 
- Requires information about the number of latent entities a priori and it is very informative.
\textcolor{red}{[[Ask Beka for Fig 2 in SMERED paper, network representation]]}

# Partition-based Bayesian clustering models

Goal: cluster N data points $x_1,\cdots, x_N$ into $K$ clusters.

\vspace{1mm}

- Place a prior distribution over partitions of $[N] = \{1,\ldots,N\}$

\vspace{1mm}

- Let $C_N$ be a random partition of $[N]$

\vspace{1mm}

- $C_N$ represented by a set of cluster assignments $z_1,\ldots ,z_N$.

\vspace{1mm}

- The number of clusters $K$ does not need to be specified a priori $\rightarrow$
\textcolor{blue}{Non-parametric} latent variable approach.


# Record Linkage and Microclustering

\begin{figure}
\vspace*{-1.3cm}
\hspace*{7.5cm} \includegraphics[scale=0.24,keepaspectratio]{figures/HRDAG-Staging-Logo-2}
\end{figure}
\hspace{-1cm}
\begin{minipage}{4cm}
\vspace{-1cm}
%\includegraphics[height=5cm, width=3.5cm]{horner}
 \includegraphics[scale=0.45,keepaspectratio]{figures/syria-sizes}
\end{minipage}
\hspace{0.5cm}
\begin{minipage}{7cm}
\vspace{-1.5cm}
- Enumeration of victims of killings in Syria merging four databases.
\vspace{1cm}

- The number of data points in each cluster should remain small even for large data sets $\rightarrow$ Large number of singletons and small clusters.
\end{minipage}

# Mixture Models

Other clustering tasks require models that assume cluster sizes
grow linearly with the size of the data set.

\begin{itemize}

\item Dirichlet process (DP)  $\Longrightarrow$
Chinese Restaurant Process (CRP)
\begin{figure}
\includegraphics[scale=0.6,keepaspectratio]{figures/chinesealpha}
\end{figure}
\item Carmona C., Nieto-Barajas L., Canale A. (2017), Model-based approach for household clustering with mixed scale variables \url{https://arxiv.org/abs/1612.00083} .
\end{itemize}

<!--The Ministry of Social Development in Mexico is in charge of creating and assigning social programmes targeting specific needs in the population for the improvement of quality of life. To better target the social programmes, the Ministry is aimed to find clusters of households with the same needs based on demographic characteristics as well as poverty conditions of the household.--> 

# Microclustering models

- Prior distributions on partitions that are suitable for the microclustering problem.
    * Zanella et al (2016). Flexible Models for Microclustering with Applications to Entity Resolution, Advances in Neural Information Processing Systems (NIPS), Vol. 29, pp 1417-1425.

\vspace{1mm}

- Scalable sampling algorithm in combination with blocking techniques.
    * Miller et al (2015). The Microclustering Problem: When the
Cluster Sizes Don't Grow with the Number of Data Points. NIPS Bayesian Nonparametrics: The Next Generation Workshop Series.


# blink

Describe in deatil the blink model, likelihood , prior and hyperparameters
<!-- Smered only handles categorical same as microclustering and Maurcio's paper is for two files and handles strings too?
 
 blink handles both sting and categorical, see comparison with smered in eblink paper-->
 

# blink package


# Example (RL500)


